<!DOCTYPE html>
<html lang="en">
	<head>
		<title>WebGL Eve local</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				color: #fff;
				font-family:Monospace;
				font-size:13px;
				margin: 0px;
				text-align:center;
				overflow: hidden;
			}
			#info{ position: absolute; width: 100%; padding: 5px; }
		</style>
	</head>
	<body>

		<div id="container"></div>
		

		<script src="../libs/three.min.js"></script>
		<script src="../js/geometries/DecalGeometry.js"></script>
		<script src="../js/controls/OrbitControls.js"></script>
		<script src="../libs/dat.gui.min.js"></script>

		<script>

		var container = document.getElementById( 'container' );

		var renderer, scene, camera, fov = 45;
		var mesh, decal;
		var raycaster;
		var line;
		var ReadyToMove = false;
		var geostart = -50
		var lightHelper

		var intersection = {
			intersects: false,
			point: new THREE.Vector3(),
			normal: new THREE.Vector3()
		};
		var controls;
		var mouse = new THREE.Vector2();

		var textureLoader = new THREE.TextureLoader();
		// var decalDiffuse = textureLoader.load( '../textures/decal/decal-diffuse.png' );
		// var decalNormal = textureLoader.load( '../textures/decal/decal-normal.jpg' );

		// var decalMaterial = new THREE.MeshPhongMaterial( {
		// 	specular: 0x444444,
		// 	map: decalDiffuse,
		// 	normalMap: decalNormal,
		// 	normalScale: new THREE.Vector2( 1, 1 ),
		// 	shininess: 30,
		// 	transparent: true,
		// 	depthTest: true,
		// 	depthWrite: false,
		// 	polygonOffset: true,
		// 	polygonOffsetFactor: - 4,
		// 	wireframe: false
		// } );

		// var decals = [];
		// var decalHelper; 
		var mouseHelper;
		var p = new THREE.Vector3( 0, 0, 0 );
		var r = new THREE.Vector3( 0, 0, 0 );
		var s = new THREE.Vector3( 10, 10, 10 );
		var up = new THREE.Vector3( 0, 1, 0 );
		var check = new THREE.Vector3( 1, 1, 1 );


		var params = {
			projection: 'normal',
			minScale: 10,
			maxScale: 20,
			rotate: true,
			clear: function() {

				// removeDecals();

			}
		};

		window.addEventListener( 'load', init );

		function init() {

			renderer = new THREE.WebGLRenderer( { antialias: true } );
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight );
			container.appendChild( renderer.domElement );

			scene = new THREE.Scene();

			camera = new THREE.PerspectiveCamera( fov, window.innerWidth / window.innerHeight, 1, 1000 );
			camera.position.z = 100;
			camera.target = new THREE.Vector3();

			// controls = new THREE.OrbitControls( camera, renderer.domElement );
			// controls.minDistance = 50;
			// controls.maxDistance = 200;

			scene.add( new THREE.AmbientLight( 0x443333 ) );

			var light = new THREE.DirectionalLight( 0xffddcc, 1 );
			light.position.set( 1, 0.75, 0.5 );
			scene.add( light );
				lightHelper = new THREE.DirectionalLightHelper( light,50 );
			scene.add( lightHelper );

//red light
			var light = new THREE.DirectionalLight( 0xFF0000, 1 );
			light.position.set( -1, 0.75, -0.5 );
			scene.add( light );
			lightHelper = new THREE.DirectionalLightHelper( light,50 );
			scene.add( lightHelper );
			

			

			loadLeePerrySmith();


			window.addEventListener( 'resize', onWindowResize, false );

		

			window.addEventListener( 'mousedown', function () {
				ReadyToMove = true;
				// moved = false;

			}, false );



			// window.addEventListener( 'mousemove', onTouchMove );
			// window.addEventListener( 'touchmove', onTouchMove );

			

			

			onWindowResize();
			animate();

		}

		function loadLeePerrySmith( callback ) {

			var loader = new THREE.JSONLoader();

			loader.load( '../models/evehead1/ESP.js', function( geometry ) {

				var material = new THREE.MeshPhongMaterial( {
					specular: 0x111111,
					// map: textureLoader.load( '../models/leeperrysmith/Map-COL.jpg' ),

					map: textureLoader.load( '../models/evehead1/ESP.jpg' ),
					// specularMap: textureLoader.load( '../models/evehead1/ESP.jpg' ),
					// normalMap: textureLoader.load( '../models/evehead1/ESP.jpg'),
					// normalScale: new THREE.Vector2( 0.75, 0.75 ),
					shininess: 25
				} );

				mesh = new THREE.Mesh( geometry, material );
				scene.add( mesh );
				mesh.scale.set( 10, 10, 10 );
				mesh.position.set(0,0,geostart)

				//scene.add( new THREE.FaceNormalsHelper( mesh, 1 ) );
				//scene.add( new THREE.VertexNormalsHelper( mesh, 1 ) );

			} );

		}

		

		

		function onWindowResize() {

			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize( window.innerWidth, window.innerHeight );

		}

		function animate() {

			if (ReadyToMove==true){
				console.log(camera.position.z)
			mesh.rotation.y = mesh.rotation.y-.018;
			mesh.position.y = mesh.position.y-.1
			camera.position.z --
			}

			if (camera.position.z < -80){
				ReadyToMove = false
			}


			requestAnimationFrame( animate );

			renderer.render( scene, camera );

		}

		</script>

	</body>
</html>